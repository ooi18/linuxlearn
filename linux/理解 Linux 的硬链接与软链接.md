理解 Linux 的硬链接与软链接
====

[文章地址](https://www.ibm.com/developerworks/cn/linux/l-cn-hardandsymb-links/index.html)


> 现代操作系统为解决信息能独立于进程之外被长期存储引入了文件，文件作为进程创建信息的逻辑单元可被多个进程并发使用。在 UNIX 系统中，操作系统为磁盘上的文本与图像、鼠标与键盘等输入设备及网络交互等 I/O 操作设计了一组通用 API，使他们被处理时均可统一使用字节流方式。换言之，UNIX 系统中除进程之外的一切皆是文件，而 Linux 保持了这一特性。为了便于文件的管理，Linux 还引入了目录（有时亦被称为文件夹）这一概念。目录使文件可被分类管理，且目录的引入使 Linux 的文件系统形成一个层级结构的目录树。清单 1.所示的是普通 Linux 系统的顶层目录结构，其中 /dev 是存放了设备相关文件的目录。


硬链接与软连接的联系与区别?
===

在 linux 上被分为两部分: 用户数据(user  data)+元数据(metadata)

用户数据: 即文件数据块,数据库是记录文件真实内容的地方;

元数据:则是文件的附加属性,例如文件大小,创建时间,所有者等信息.在 Linux 中，元数据中的 inode 号（inode 是文件元数据的一部分但其并不包含文件名，inode 号即索引节点号）才是文件的唯一标识而非文件名。文件名仅是为了方便人们的记忆和使用，系统或程序通过 inode 号寻找正确的文件数据块。


通过文件名打开文件:

``` 
                      |
[filename]->[node]----|-->[data blocks]
             metadata |  user data         
```

硬链接创建命令:

```
link oldfile newfile
ln oldfile newfile
```

硬链接特点: 

* 文件有相同的 inode 及 data block；
* 只能对已存在的文件进行创建；
* 不能交叉文件系统进行硬链接的创建；
* 不能对目录进行创建，只可对文件创建；
* 删除一个硬链接文件并不影响其他有相同 inode 号的文件。


查看相同的 inode 号

```
# df命令输出类型
df -i --print-type

# 根据 inode 号,搜索
find / -inum 1114 
```

软链接特点:

* 软链接有自己的文件属性及权限等；
* 可对不存在的文件或目录创建软链接；
* 软链接可交叉文件系统；
* 软链接可对文件或目录创建；
* 创建软链接时，链接计数 i_nlink 不会增加；
* 删除软链接并不影响被指向的文件，但若被指向的原文件被删除，则相关软连接被称为死链接（即 dangling link，若被指向路径文件被重新创建，死链接可恢复为正常的软链接）。



软连接的访问
```
[heard link]  [file]  [soft link]
   \           / \  \     |
    \         /   \  \    |
      [inode]      \  [inode]
        |           \
        |            \
      [data block]   [data block]
```



