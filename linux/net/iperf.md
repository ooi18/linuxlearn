> iperf命令是一个网络性能测试工具。iperf可以测试TCP和UDP带宽质量。iperf可以测量最大TCP带宽，具有多种参数和UDP特性。iperf可以报告带宽，延迟抖动和数据包丢失。利用iperf这一特性，可以用来测试一些网络设备如路由器，防火墙，交换机等的性能。

> [参考](http://man.linuxde.net/iperf)

> 默认端口 5001 

UDP模式
----

服务器端：

    iperf -u -s
客户端：

    iperf -u -c 192.168.1.1 -b 100M -t 60
在udp模式下，以100Mbps为数据发送速率，客户端到服务器192.168.1.1上传带宽测试，测试时间为60秒。

    iperf -u -c 192.168.1.1 -b 5M -P 30 -t 60
客户端同时向服务器端发起30个连接线程，以5Mbps为数据发送速率。

    iperf -u -c 192.168.1.1 -b 100M -d -t 60 -p 5001
    
以100M为数据发送速率，进行上下行带宽测试。


TCP模式
----

服务器端：

    iperf -s
客户端：

    iperf -c 192.168.1.1 -t 60
在tcp模式下，客户端到服务器192.168.1.1上传带宽测试，测试时间为60秒。

    iperf -c 192.168.1.1  -P 30 -t 60
客户端同时向服务器端发起30个连接线程。

    iperf -c 192.168.1.1  -d -t 60
进行上下行带宽测试。

iperf3
----

- 目标机器上面启动 iperf服务端

    # -s 表示启动服务端，-i 表示汇报间隔，-p 表示监听端口
    $ iperf3 -s -i 1 -p 10000

- 在另外一台机器上运行 iperf 客户端


    # -c 表示启动客户端，192.168.0.30 为目标服务器的 IP
    # -b 表示目标带宽 (单位是 bits/s)
    # -t 表示测试时间
    # -P 表示并发数，-p 表示目标服务器监听端口
    $ iperf3 -c 192.168.0.30 -b 1G -t 15 -P 2 -p 10000

测试报告

    [ ID] Interval           Transfer     Bandwidth
    ...
    [SUM]   0.00-15.04  sec  3.47 GBytes  1.98 Gbits/sec    0             sender
    [SUM]   0.00-15.04  sec  3.47 GBytes  1.98 Gbits/sec                  receiver


最后的SUM 行就是测试的汇总结果,包括测试事件,数据传输量,以及带宽等. 可以看出我们目标带宽为 1G,测试结果为 1.98G,超过我们的预期,我们可以继续加大目标带宽直到,结果准确为止.

- HTTP 性能

